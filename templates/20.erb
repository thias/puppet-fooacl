<%
if @target.is_a?(String)
  target = @target.lines
elsif @target.is_a?(Array)
  target = @target
end
if @permissions.is_a?(String)
  _permissions = @permissions.lines
  if _permissions.is_a?(String)
    permissions = [_permissions]
  elsif _permissions.is_a?(Array)
    permissions = _permissions
  elsif _permissions.is_a?(Enumerable)
    permissions = _permissions.to_a
  else
    fail("Wrong type for permissions: #{_permissions.class}")
  end
elsif @permissions.is_a?(Array)
  permissions = @permissions
end
-%>
<% target.each do |f| -%>
<% if f == 'default' -%>
ACLOPTS_GLOBAL+="<% permissions.flatten.each do |p| %> -m <%= p %> -m d:<%= p %><% end %>"
<% else -%>
ACLOPTS[<%= f %>]+="<% permissions.flatten.each do |p| %> -m <%= p %> -m d:<%= p %><% end %>"
<% end -%>
<% end -%>
